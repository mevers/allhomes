<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Modelling the unimproved value in the ACT's Woden Valley • allhomes</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Modelling the unimproved value in the ACT's Woden Valley">
<meta property="og:description" content="allhomes">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">allhomes</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.2.4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li class="divider">
    </li>
<li class="dropdown-header">Simple examples</li>
    <li>
      <a href="../articles/price_bedrooms.html">Price as a function of the no. of bedrooms across three North Canberra suburbs</a>
    </li>
    <li>
      <a href="../articles/median_price_Leichhardt.html">Median sale prices across Sydney Leichhard suburbs in 2021</a>
    </li>
    <li class="divider">
    </li>
<li class="dropdown-header">Case studies</li>
    <li>
      <a href="../articles/UV_model.html">Modelling the unimproved value in the ACT's Woden Valley</a>
    </li>
    <li>
      <a href="../articles/spatial_median_price.html">Variability of the unimproved value per sqm across the ACT</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Modelling the unimproved value in the ACT’s Woden Valley</h1>
                        <h4 data-toc-skip class="author">Maurits Evers</h4>
            
            <h4 data-toc-skip class="date">2022-09-01</h4>
      
      
      <div class="hidden name"><code>UV_model.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="goal">Goal<a class="anchor" aria-label="anchor" href="#goal"></a>
</h2>
<p>The goal of this case study is to show how to use <code>allhomes</code> to pull in past sales data for various ACT suburbs and then fit a mixed-effect model using Stan to predict the unimproved value (UV, i.e. the value of the plot of land itself) as a function of the block size (in square-meters), the year of the sale and the suburb. We then explore the output of the model and interpret its results.</p>
<p>Taking inspiration from examples &amp; modelling discussions given in <a href="https://avehtari.github.io/ROS-Examples/" class="external-link">Gelman, Hill and Vehtari, Regression and Other Stories</a>, this case study also serves as an example of how to fit a mixed-effect model to real-world data and interpret results; as will become clear, the model fit is not particularly good in the sense that a lot of the observed variability remains unexplained by the model’s input variables. However, the case study is useful in the context of exploring model results and different aspects of the model fit, and represents the kind of analysis one might perform when exploring a new real-world dataset.</p>
</div>
<div class="section level2">
<h2 id="prerequisities">Prerequisities<a class="anchor" aria-label="anchor" href="#prerequisities"></a>
</h2>
<p>We load necessary non-base R libraries.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://mevers.github.io/allhomes/">allhomes</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://mc-stan.org/rstanarm/" class="external-link">rstanarm</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://mc-stan.org/bayesplot/" class="external-link">bayesplot</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://mjskay.github.io/tidybayes/" class="external-link">tidybayes</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://modelr.tidyverse.org" class="external-link">modelr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/karthik/wesanderson" class="external-link">wesanderson</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>mc.cores <span class="op">=</span> <span class="fu">parallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/parallel/detectCores.html" class="external-link">detectCores</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">pal</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/wesanderson/man/wes_palette.html" class="external-link">wes_palette</a></span><span class="op">(</span><span class="st">"GrandBudapest1"</span>, n <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="raw-data">Raw data<a class="anchor" aria-label="anchor" href="#raw-data"></a>
</h2>
<p>We get past sales for all suburbs in ACT’s Woden Valley from the last 10 years. This is easily done by using the <code><a href="../reference/divisions_ACT.html">allhomes::divisions_ACT</a></code> dataset, and then filter divisions (i.e. suburbs) based on their corresponding <a href="https://www.abs.gov.au/ausstats/abs@.nsf/Lookup/by%20Subject/1270.0.55.001~July%202016~Main%20Features~Statistical%20Area%20Level%203%20(SA3)~10015" class="external-link">SA3 regions</a>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_past_sales_data.html">get_past_sales_data</a></span><span class="op">(</span></span>
<span>    <span class="va">divisions_ACT</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>        <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">sa3_name_2016</span> <span class="op">==</span> <span class="st">"Woden Valley"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>        <span class="fu"><a href="https://tidyr.tidyverse.org/reference/unite.html" class="external-link">unite</a></span><span class="op">(</span><span class="va">suburb</span>, <span class="va">division</span>, <span class="va">state</span>, sep <span class="op">=</span> <span class="st">", "</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>        <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">suburb</span><span class="op">)</span>,</span>
<span>    <span class="fl">2011L</span><span class="op">:</span><span class="fl">2020L</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="data-processing">Data processing<a class="anchor" aria-label="anchor" href="#data-processing"></a>
</h2>
<p>Since we want to build a predictive model that allows us to estimate the residential unimproved value (UV) of a property based on its block size and location, we keep only those records where we have data for the UV and block size (i.e. we omit records where any of these fields are <code>NA</code>) and further limit block sizes to less than 2000 sqm and UVs to less than 2 million dollars (this is to exclude large commercial purchases).</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data_model</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">division</span>, <span class="va">unimproved_value</span>, <span class="va">block_size</span>, <span class="va">year</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span></span>
<span>        <span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html" class="external-link">if_all</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html" class="external-link">everything</a></span><span class="op">(</span><span class="op">)</span>, <span class="op">~</span> <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">.x</span><span class="op">)</span> <span class="op">&amp;</span> <span class="va">.x</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span>,</span>
<span>        <span class="va">block_size</span> <span class="op">&lt;</span> <span class="fl">2000</span>, <span class="va">unimproved_value</span> <span class="op">&lt;</span> <span class="fl">2e6</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="co"># Variable transformations</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>        <span class="co"># Year since 2019</span></span>
<span>        year_since <span class="op">=</span> <span class="va">year</span> <span class="op">-</span> <span class="fl">2019L</span>,</span>
<span>        <span class="co"># log-transformed UV</span></span>
<span>        log_UV <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">unimproved_value</span><span class="op">)</span>,</span>
<span>        <span class="co"># log-transformed block_size, standardised to the log of median value</span></span>
<span>        log_block_size_std <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">block_size</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">850</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">data_model</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 3,473 × 7</span></span></span>
<span><span class="co">#&gt;    division unimproved_value block_size  year year_since log_UV log_block_size…¹</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>               <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> Chifley            <span style="text-decoration: underline;">444</span>000       <span style="text-decoration: underline;">1</span>048  <span style="text-decoration: underline;">2</span>011         -<span style="color: #BB0000;">8</span>   13.0           0.209 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> Chifley            <span style="text-decoration: underline;">451</span>000        760  <span style="text-decoration: underline;">2</span>011         -<span style="color: #BB0000;">8</span>   13.0          -<span style="color: #BB0000;">0.112</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> Chifley            <span style="text-decoration: underline;">366</span>000       <span style="text-decoration: underline;">1</span>020  <span style="text-decoration: underline;">2</span>011         -<span style="color: #BB0000;">8</span>   12.8           0.182 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> Chifley            <span style="text-decoration: underline;">486</span>000        990  <span style="text-decoration: underline;">2</span>011         -<span style="color: #BB0000;">8</span>   13.1           0.152 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> Chifley            <span style="text-decoration: underline;">451</span>000        719  <span style="text-decoration: underline;">2</span>011         -<span style="color: #BB0000;">8</span>   13.0          -<span style="color: #BB0000;">0.167</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> Chifley            <span style="text-decoration: underline;">451</span>000        743  <span style="text-decoration: underline;">2</span>011         -<span style="color: #BB0000;">8</span>   13.0          -<span style="color: #BB0000;">0.135</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> Chifley            <span style="text-decoration: underline;">450</span>000       <span style="text-decoration: underline;">1</span>330  <span style="text-decoration: underline;">2</span>011         -<span style="color: #BB0000;">8</span>   13.0           0.448 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> Chifley            <span style="text-decoration: underline;">343</span>000        889  <span style="text-decoration: underline;">2</span>011         -<span style="color: #BB0000;">8</span>   12.7           0.044<span style="text-decoration: underline;">9</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> Chifley            <span style="text-decoration: underline;">382</span>000        796  <span style="text-decoration: underline;">2</span>011         -<span style="color: #BB0000;">8</span>   12.9          -<span style="color: #BB0000;">0.065</span><span style="color: #BB0000; text-decoration: underline;">6</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> Chifley            <span style="text-decoration: underline;">359</span>000        695  <span style="text-decoration: underline;">2</span>011         -<span style="color: #BB0000;">8</span>   12.8          -<span style="color: #BB0000;">0.201</span> </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># … with 3,463 more rows, and abbreviated variable name ¹​log_block_size_std</span></span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="fitting-the-model">Fitting the model<a class="anchor" aria-label="anchor" href="#fitting-the-model"></a>
</h2>
<div class="section level3">
<h3 id="model-formulation">Model formulation<a class="anchor" aria-label="anchor" href="#model-formulation"></a>
</h3>
<p>We now use <code>rstanarm</code> to fit a model using full Bayesian inference in Stan. We assume that the effects that the log-transformed block size and the (shifted) year have on the log-tranformed UV vary by division (i.e. suburb). To model this, we consider a fixed and a random effect component to both the overall intercept and predictor coefficient estimates: The fixed effects characterise the effects that are <em>common across divisions</em>, and the random effects are expressed as deviations from the fixed effects that <em>vary across divisions</em>.</p>
<p>Written out, the model takes the following form</p>
<p><span class="math display">\[
\begin{align}
\mathtt{log\_UV} &amp;\sim N\left(\mu, \sigma\right)\\
\mu &amp;= \mu_\alpha + \alpha_{[i]} + \left(\mu_{\beta_1} + \beta_{1, [i]} \right) \mathtt{year\_since} + \left(\mu_{\beta_2} + \beta_{2,[i]}\right) \mathtt{log\_block\_size\_std}\\
\end{align}
\]</span></p>
<p>where <span class="math display">\[
\begin{align}
\mathtt{year\_since} &amp;= \mathtt{year} - 2019\,,\\
\mathtt{log\_block\_size\_std} &amp;= \log{(\mathtt{block\_size})} - \log{(850)}\,.
\end{align}
\]</span> Such a model is motivated by the assumption that estimates characterising the change in log-transformed UV are expected to have a fixed component and a random suburb-dependent component. In other words division-level estimates are expected to be normally distributed around a mean value, i.e. the fixed effect. Using division as a random (rather than fixed) effect allows for partial pooling of observations across divisions when estimating division-level effects.</p>
<p>The reason for the particular variable transformations are summarised in the following bullet points:</p>
<ul>
<li><p><code>year_since</code> is the shifted <code>year</code> such that <code>year_since = 0</code> corresponds to 2019. In other words, 2019 was arbitrarily chosen as the reference year.</p></li>
<li><p><code>log_block_size_std</code> is the log-transformed and then shifted block size; we log-transform values since the block size cannot become negative; shifting the log-transformed values means that <code>log_block_size_std = 0</code> corresponds to a block size of 850 <span class="math inline">\(m^2\)</span>, which is roughly the median block size value across all past sale records.</p></li>
</ul>
<p>Chapter 12 of <a href="https://avehtari.github.io/ROS-Examples/" class="external-link">Gelman, Hill and Vehtari, Regression and Other Stories</a> has a great discussion and examples on variable transformations and what would motivate them.</p>
<p>We fit the model using standard <code>lmer</code>/<code>lme4</code>-syntax in Stan using <code><a href="https://mc-stan.org/rstanarm/reference/stan_glmer.html" class="external-link">rstanarm::stan_glmer()</a></code>.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://mc-stan.org/rstanarm/reference/stan_glmer.html" class="external-link">stan_glmer</a></span><span class="op">(</span></span>
<span>    <span class="va">log_UV</span> <span class="op">~</span> <span class="fl">1</span> <span class="op">+</span> <span class="va">year_since</span> <span class="op">+</span> <span class="va">log_block_size_std</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="va">year_since</span> <span class="op">+</span> <span class="va">log_block_size_std</span> <span class="op">|</span> <span class="va">division</span><span class="op">)</span>,</span>
<span>    data <span class="op">=</span> <span class="va">data_model</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="model-diagnostics">Model diagnostics<a class="anchor" aria-label="anchor" href="#model-diagnostics"></a>
</h3>
<p>We inspect pairwise correlations between the fixed-effect parameter estimates in bivariate scatter plots. This is useful for identifying divergencies, collinearities and multiplicative non-identifiabilities.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://mc-stan.org/bayesplot/reference/bayesplot_theme_get.html" class="external-link">bayesplot_theme_set</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://mc-stan.org/bayesplot/reference/bayesplot-colors.html" class="external-link">color_scheme_set</a></span><span class="op">(</span>scheme <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">pal</span>, <span class="va">pal</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/pairs.html" class="external-link">pairs</a></span><span class="op">(</span></span>
<span>    <span class="va">model</span>, </span>
<span>    pars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"(Intercept)"</span>, <span class="st">"year_since"</span>, <span class="st">"log_block_size_std"</span>, <span class="st">"sigma"</span><span class="op">)</span>,</span>
<span>    transformations <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>sigma <span class="op">=</span> <span class="st">"log"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="UV_model_files/figure-html/pairs-1.png" width="672"></p>
<p>We note that there are no divergent transitions, and the Gaussian blobs/clouds suggest that there are no major issues with our estimates (see <a href="https://cran.r-project.org/web/packages/bayesplot/vignettes/visual-mcmc-diagnostics.html" class="external-link">Visual MCMC diagnostics using the bayesplot package</a> for a lot more details on MCMC diagnostics).</p>
<p>Next, we compare samples drawn from the posterior predictive distribution with <span class="math inline">\(\mathtt{log\_UV}\)</span> values, and show the distribution of <a href="http://www.stat.columbia.edu/~gelman/research/published/bayes_R2_v3.pdf" class="external-link">leave-one-out (LOO)-adjusted R-squared</a> values <span class="math inline">\(R^2_s\)</span>.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://mc-stan.org/bayesplot/reference/PPC-distributions.html" class="external-link">ppc_dens_overlay</a></span><span class="op">(</span><span class="va">data_model</span><span class="op">$</span><span class="va">log_UV</span>, <span class="fu"><a href="https://mc-stan.org/rstantools/reference/posterior_predict.html" class="external-link">posterior_predict</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>        x <span class="op">=</span> <span class="st">"log(UV)"</span>,</span>
<span>        y <span class="op">=</span> <span class="st">"density"</span>,</span>
<span>        title <span class="op">=</span> <span class="st">"Posterior predictive check"</span><span class="op">)</span></span>
<span><span class="va">loo_r2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://mc-stan.org/rstantools/reference/bayes_R2.html" class="external-link">loo_R2</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: Some Pareto k diagnostic values are too high. See help('pareto-k-diagnostic') for details.</span></span>
<span><span class="va">loo_r2</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://tibble.tidyverse.org/reference/enframe.html" class="external-link">enframe</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html" class="external-link">geom_density</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>        x <span class="op">=</span> <span class="st">"R²"</span>,</span>
<span>        y <span class="op">=</span> <span class="st">"density"</span>,</span>
<span>        title <span class="op">=</span> <span class="st">"Bayesian R² distribution"</span><span class="op">)</span></span></code></pre></div>
<p><img src="UV_model_files/figure-html/loo-r-squared-1.png" width="47%"><img src="UV_model_files/figure-html/loo-r-squared-2.png" width="47%"></p>
<p>The posterior predictive check suggests some issues with the model fit. Of note, the actual <span class="math inline">\(\mathtt{log\_UV}\)</span> distribution shows a small bump at values <span class="math inline">\(\log{\mathrm{UV}} &gt; 14\)</span> (corresponding to values greater than $1.2 million) which is not reproduced by the model. Instead these large UV values pull the mean of the posterior predictive to a slightly larger value than that of the actual distribution. The median Bayesian <span class="math inline">\(R^2_s\)</span> value of 0.48 also indicates that this is not a great fit; or in other words: there is a lot of unexplained (residual) variance.</p>
</div>
</div>
<div class="section level2">
<h2 id="model-results">Model results<a class="anchor" aria-label="anchor" href="#model-results"></a>
</h2>
<p>We show and interpret fixed and random-effect parameter estimates. <code><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">broom.mixed::tidy()</a></code> makes it easy to extract estimates in a standardised format.</p>
<div class="section level3">
<h3 id="interpretation-of-fixed-effect-estimates">Interpretation of fixed effect estimates<a class="anchor" aria-label="anchor" href="#interpretation-of-fixed-effect-estimates"></a>
</h3>
<p>We show fixed parameter estimates (mean and standard deviation) including 95% uncertainty estimates (based on the 2.5% and 97.5% quantiles of the marginal posteriors).</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">effect_fixed</span> <span class="op">&lt;-</span> <span class="fu">broom.mixed</span><span class="fu">::</span><span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy</a></span><span class="op">(</span><span class="va">model</span>, <span class="st">"fixed"</span>, conf.int <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">effect_fixed</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 3 × 5</span></span></span>
<span><span class="co">#&gt;   term               estimate std.error conf.low conf.high</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                 <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> (Intercept)         13.3      0.060<span style="text-decoration: underline;">7</span>   13.2      13.4   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> year_since           0.021<span style="text-decoration: underline;">2</span>   0.001<span style="text-decoration: underline;">72</span>   0.018<span style="text-decoration: underline;">2</span>    0.024<span style="text-decoration: underline;">0</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> log_block_size_std   0.461    0.052<span style="text-decoration: underline;">3</span>    0.373     0.549</span></span></code></pre></div>
<ul>
<li><p>The intercept estimate is <span class="math inline">\(\mu_\alpha\)</span> = 13.3. This means that the estimated fixed-effect UV in 2019 of a block the size of 850 <span class="math inline">\(\mathrm{m}^2\)</span> is approximately <span class="math inline">\(\exp{(\mu_\alpha)}\)</span> = $580.5k.</p></li>
<li><p>The coefficient estimate for <code>year_since</code> of <span class="math inline">\(\mu_{\beta_1}\)</span> = 0.0212 means that the fixed-effect UV of a block the size of 850 <span class="math inline">\(\mathrm{m}^2\)</span> increases every year by a factor of <span class="math inline">\(\exp{(\mu_{\beta_1})}\)</span> = 1.02, i.e. by around 2%.</p></li>
<li><p>The coefficient estimate for <code>log_block_size_std</code> of <span class="math inline">\(\mu_{\beta_2}\)</span> = 0.461 means that a 10% increase in block size in 2019 translated into a <span class="math inline">\(\exp{(\mu_{\beta_2} \log(1.1))}\)</span> = 1.04 factor increase in the UV, i.e. a 4% increase (in the UV).</p></li>
</ul>
<p>We can compare fixed-effect estimates from the mixed-effect model with those from a complete pooling model, i.e. a model where we ignore any division-level differences.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model_complete_pooling</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://mc-stan.org/rstanarm/reference/stan_glm.html" class="external-link">stan_glm</a></span><span class="op">(</span></span>
<span>    <span class="va">log_UV</span> <span class="op">~</span> <span class="fl">1</span> <span class="op">+</span> <span class="va">year_since</span> <span class="op">+</span> <span class="va">log_block_size_std</span>,</span>
<span>    data <span class="op">=</span> <span class="va">data_model</span><span class="op">)</span></span>
<span><span class="fu">broom</span><span class="fu">::</span><span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy</a></span><span class="op">(</span><span class="va">model_complete_pooling</span>, <span class="st">"fixed"</span>, conf.int <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 3 × 5</span></span></span>
<span><span class="co">#&gt;   term               estimate std.error conf.low conf.high</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                 <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> (Intercept)         13.2      0.006<span style="text-decoration: underline;">61</span>  13.2      13.2   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> year_since           0.018<span style="text-decoration: underline;">5</span>   0.001<span style="text-decoration: underline;">46</span>   0.016<span style="text-decoration: underline;">0</span>    0.020<span style="text-decoration: underline;">9</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> log_block_size_std   0.403    0.012<span style="text-decoration: underline;">2</span>    0.383     0.422</span></span></code></pre></div>
<p>We note the wider uncertainty intervals in the fixed-effect estimates of the mixed-effect model, which are probably more realistic given the variability in division-level effects.</p>
</div>
<div class="section level3">
<h3 id="interpretation-of-random-effect-estimates">Interpretation of random effect estimates<a class="anchor" aria-label="anchor" href="#interpretation-of-random-effect-estimates"></a>
</h3>
<p>Random-effect estimates are shown as standard deviations of the underlying (normal) distributions and correlation coefficients of the covariance matrix. The following table summarises those estimates including the residual standard deviaton <span class="math inline">\(\sigma\)</span>.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">effect_random</span> <span class="op">&lt;-</span> <span class="fu">broom.mixed</span><span class="fu">::</span><span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy</a></span><span class="op">(</span><span class="va">model</span>, <span class="st">"ran_pars"</span>, conf.int <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">effect_random</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 7 × 3</span></span></span>
<span><span class="co">#&gt;   term                                        group     estimate</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                                       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> sd_(Intercept).division                     division  0.226   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> sd_year_since.division                      division  0.004<span style="text-decoration: underline;">10</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> sd_log_block_size_std.division              division  0.180   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> cor_(Intercept).year_since.division         division -<span style="color: #BB0000;">0.155</span>   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> cor_(Intercept).log_block_size_std.division division  0.001<span style="text-decoration: underline;">05</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> cor_year_since.log_block_size_std.division  division -<span style="color: #BB0000;">0.000</span><span style="color: #BB0000; text-decoration: underline;">201</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">7</span> sd_Observation.Residual                     Residual  0.211</span></span></code></pre></div>
<ul>
<li><p>The standard deviation estimate for the random-effect intercept distribution of <span class="math inline">\(\mathrm{sd}(\alpha_{[i]})\)</span> = 0.226 means that 68% of properties (in 2019 with a block size of 850 <span class="math inline">\(\mathrm{m}^2\)</span>) across all divisions have a UV in the range of <span class="math inline">\([\mu_\alpha - \mathrm{sd}(\alpha_{[i]}), \mu_\alpha + \mathrm{sd}(\alpha_{[i]})]\)</span> = [$463k, $727.9k].</p></li>
<li><p>The standard deviation estimate for the random-effect component of the <code>year_since</code> effect is <span class="math inline">\(\mathrm{sd}(\beta_{1,[i]})\)</span> = 0.0041; this means that the per-year UV increase of 68% of properties (with a block size of 850 <span class="math inline">\(\mathrm{m}^2\)</span>) across all divisions is in the range of <span class="math inline">\([\mu_{\beta_1} - \mathrm{sd}(\beta_{1,[i]}), \mu_{\beta_1} + \mathrm{sd}(\beta_{1,[i]})]\)</span> = [1.7%, 2.6%].</p></li>
<li><p>The standard deviation estimate for the random-effect component of the <code>log_block_size_std</code> effect is <span class="math inline">\(\mathrm{sd}(\beta_{2,[i]})\)</span> = 0.18; this means that a 10% increase in block size of 68% of properties across all divisions in 2019 translated into a UV increase in the range of [2.7%, 6.3%].</p></li>
</ul>
</div>
<div class="section level3">
<h3 id="forecasts">Forecasts<a class="anchor" aria-label="anchor" href="#forecasts"></a>
</h3>
<p>We use the model to predict UV values across all Woden valley suburbs for three years (2010, 2020 and 2030) as a function of block size. This is easy to do by using <code><a href="https://modelr.tidyverse.org/reference/data_grid.html" class="external-link">modelr::data_grid()</a></code> to create a grid of values which are then used as input to the model; <code><a href="http://mjskay.github.io/tidybayes/reference/add_predicted_draws.html" class="external-link">tidybayes::add_predicted_draws()</a></code> then draws samples from the posterior predictive distribution conditional on the generated input data.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data_pred</span> <span class="op">&lt;-</span> <span class="va">data_model</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://modelr.tidyverse.org/reference/data_grid.html" class="external-link">data_grid</a></span><span class="op">(</span></span>
<span>        division <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">division</span><span class="op">)</span>,</span>
<span>        year_since <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2010L</span>, <span class="fl">2020L</span>, <span class="fl">2030L</span><span class="op">)</span> <span class="op">-</span> <span class="fl">2019L</span>,</span>
<span>        log_block_size_std <span class="op">=</span> <span class="fu"><a href="https://modelr.tidyverse.org/reference/seq_range.html" class="external-link">seq_range</a></span><span class="op">(</span><span class="va">log_block_size_std</span>, n <span class="op">=</span> <span class="fl">100</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="http://mjskay.github.io/tidybayes/reference/add_predicted_draws.html" class="external-link">add_predicted_draws</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">division</span>, <span class="va">year_since</span>, <span class="va">log_block_size_std</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="http://mjskay.github.io/ggdist/reference/point_interval.html" class="external-link">median_qi</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">ungroup</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>        year <span class="op">=</span> <span class="va">year_since</span> <span class="op">+</span> <span class="fl">2019L</span>,</span>
<span>        block_size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">log_block_size_std</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">850</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>We draw the median and 95% quantile intervals of the UV predictions as a function of block size for every division (suburb) and each of the three years. The red dots are the recorded UVs for 2020.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data_pred</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>year <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">year</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">block_size</span>, <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">.prediction</span><span class="op">)</span>, colour <span class="op">=</span> <span class="va">year</span>, fill <span class="op">=</span> <span class="va">year</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span></span>
<span>        data <span class="op">=</span> <span class="va">data_model</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">year</span> <span class="op">==</span> <span class="fl">2020L</span><span class="op">)</span>, </span>
<span>        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">block_size</span>, y <span class="op">=</span> <span class="va">unimproved_value</span><span class="op">)</span>,</span>
<span>        colour <span class="op">=</span> <span class="va">pal</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,</span>
<span>        inherit.aes <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html" class="external-link">geom_ribbon</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>ymin <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">.lower</span><span class="op">)</span>, ymax <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">.upper</span><span class="op">)</span><span class="op">)</span>, colour <span class="op">=</span> <span class="cn">NA</span>, alpha <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span> <span class="va">division</span>, scales <span class="op">=</span> <span class="st">"free_y"</span>, ncol <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="va">pal</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_colour_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="va">pal</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span></span>
<span>        labels<span class="op">=</span><span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/dollar_format.html" class="external-link">dollar_format</a></span><span class="op">(</span>accuracy <span class="op">=</span> <span class="fl">1</span>, scale <span class="op">=</span> <span class="fl">1e-3</span>, suffix <span class="op">=</span> <span class="st">"k"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>        x <span class="op">=</span> <span class="st">"Block size [m²]"</span>, y <span class="op">=</span> <span class="st">"Unimproved Value (UV)"</span>, </span>
<span>        fill <span class="op">=</span> <span class="st">"Year"</span>, colour <span class="op">=</span> <span class="st">"Year"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"top"</span><span class="op">)</span></span></code></pre></div>
<p><img src="UV_model_files/figure-html/plot-forecast-2020-1.png" width="672"></p>
<p>We note a few observations:</p>
<ol style="list-style-type: decimal">
<li>
<p>Properties of around 1000 <span class="math inline">\(m^2\)</span> have the <strong>highest UV</strong> in the suburbs Phillip, Swinger Hill and Garran.</p>
<pre><code><span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 3 × 4</span></span></span>
<span><span class="co">#&gt;   division     `2010` `2020` `2030`</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> Phillip      $934k  $1110k $1350k</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> Swinger Hill $694k  $842k  $1030k</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> Garran       $610k  $730k  $884k</span></span></code></pre>
<p>Lyons, Mawson and Torrens properties of the same size have the <strong>lowest UV</strong>.</p>
<pre><code><span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 3 × 4</span></span></span>
<span><span class="co">#&gt;   division `2010` `2020` `2030`</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> Lyons    $442k  $540k  $665k </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> Mawson   $427k  $528k  $667k </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> Torrens  $417k  $513k  $632k</span></span></code></pre>
</li>
<li>
<p>The suburbs Phillip, Swinger Hill and Hughes (are predicted to) show the <strong>largest change in UV</strong> between 2010 and 2030.</p>
<pre><code><span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 3 × 3</span></span></span>
<span><span class="co">#&gt;   division     `2020 relative to previous` `2030 relative to previous`</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> Phillip      $178k                       $238k                      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> Swinger Hill $147k                       $185k                      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> Hughes       $143k                       $170k</span></span></code></pre>
<p>The suburbs Torrens, Lyons, and Mawson show the <strong>smallest change in UV</strong> during that period</p>
<pre><code><span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 3 × 3</span></span></span>
<span><span class="co">#&gt;   division `2020 relative to previous` `2030 relative to previous`</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> Mawson   $101k                       $139k                      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> Lyons    $98.2k                      $125k                      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> Torrens  $96k                        $119k</span></span></code></pre>
</li>
</ol>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Maurits Evers.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
